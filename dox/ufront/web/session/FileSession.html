<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><link href="../../../bootstrap-combined.min.css" rel="stylesheet" /><script type="text/javascript" src="../../../jquery-1.9.1.min.js"></script><script type="text/javascript" src="../../../bootstrap.min.js"></script><link href="../../../styles.css" rel="stylesheet" /><link rel="icon" href="../../../favicon.ico" type="image/x-icon"></link><script type="text/javascript" src="../../../nav.js"></script><script type="text/javascript" src="../../../index.js"></script><script type="text/javascript">var dox = {rootPath: "../../../",platforms: ["dox"]};</script><title>FileSession</title></head><body><div class="navbar navbar-inverse navbar-fixed-top"><div class="navbar-inner"><form class="navbar-search pull-left" id="searchForm"><input id="search" type="text" class="search-query" placeholder="Filter" autocomplete="off"/></form><ul class="nav"><li id="select-platform" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Platform<b class="caret"></b></a><ul class="dropdown-menu"><li data="all"><a href="#">All Platforms</a></li><li data="dox"><a href="#">dox</a></li></ul></li></ul></div></div><div id="container"><div id="nav"></div><div id="content"><div class="header"><h1><code><span class="directive">class </span><span class="type">ufront.web.session.FileSession</span><span class="keyword"> implements</span> <a class="type" href="../../../ufront/web/session/UFHttpSession.html">UFHttpSession</a></code></h1></div><div class="body"><p class="availability">Available on all platforms</p><div class="doc"><p>A session implementation using flat files.</p>
<p>Files are saved to the folder <code>savePath</code>, with one file per session.  The folder must be writeable by the web server.</p>
<p>Each session has a unique ID, which is randomly generated and used as the file.</p>
<p>The contents of the file are a serialized StringMap representing the current session.  The serialization is done using <code><a href="../../../haxe/Serializer.html">haxe.Serializer</a></code> and <code><a href="../../../haxe/Unserializer.html">haxe.Unserializer</a></code>.</p>
<p>The session ID is sent to the client as a Cookie.  When reading the SessionID, Cookies are checked first, followed by GET/POST parameters.</p>
<p>When searching the parameters or cookies for the Session ID, the name to search for is defined by the <code>sessionName</code> property.</p></div><h2>Class Fields</h2><div class="platform platform-dox"><a name="defaultExpiry"></a><h3><p><code><span class="keyword">static </span><span class="keyword">var</span> <a href="#defaultExpiry"><span class="identifier">defaultExpiry</span></a>:<a class="type" href="../../../Int.html">Int</a></code></p></h3><div class="doc"><p>The default expiry value.
The default value is 0 (expire when window is closed).
You can change the default by changing this static variable.</p></div></div><div class="platform platform-dox"><a name="defaultSavePath"></a><h3><p><code><span class="keyword">static </span><span class="keyword">var</span> <a href="#defaultSavePath"><span class="identifier">defaultSavePath</span></a>:<a class="type" href="../../../String.html">String</a></code></p></h3><div class="doc"><p>The default savePath.
This should be relative to the <code><a href="../../../ufront/web/context/HttpContext.html#contentDirectory">HttpContext.contentDirectory</a></code>, or absolute.
The default value is "sessions/".  You can change this static value to set a new default.</p></div></div><div class="platform platform-dox"><a name="defaultSessionName"></a><h3><p><code><span class="keyword">static </span><span class="keyword">var</span> <a href="#defaultSessionName"><span class="identifier">defaultSessionName</span></a>:<a class="type" href="../../../String.html">String</a></code></p></h3><div class="doc"><p>The default session name to use if none is provided.
The default value is "UfrontSessionID".
You can change this static variable to set a new default.</p></div></div><h2>Instance Fields</h2><div class="platform platform-dox"><a name="context"></a><h3><p><code><span class="keyword">var</span> <a href="#context"><span class="identifier">context</span></a>:<a class="type" href="../../../ufront/web/context/HttpContext.html">HttpContext</a></code></p></h3><div class="doc"><p>The current HttpContext, should be supplied by injection.</p></div></div><div class="platform platform-dox"><a name="expiry"></a><h3><p><code><span class="keyword">var</span> <a href="#expiry"><span class="identifier">expiry</span></a>:<a class="type" href="../../../Null.html">Null</a>&lt;<a class="type" href="../../../Int.html">Int</a>&gt;</code></p></h3><div class="doc"><p>The lifetime/expiry of the cookie, in seconds.</p>
<p>A positive value sets the cookie to expire that many seconds from the current time.
A value of 0 represents expiry when the browser window is closed.
A negative value expires the cookie immediately.</p>
<p>This is set by injecting a <code><a href="../../../ufront/core/InjectionRef.html">InjectionRef</a>&lt;<a href="../../../Int.html">Int</a>&gt; named "sessionExpiry", otherwise the default </code>defaultExpiry` value is used.</p></div></div><div class="platform platform-dox"><a name="id"></a><h3><p><code><span class="keyword">var</span> <a href="#id"><span class="identifier">id</span></a>:<a class="type" href="../../../Null.html">Null</a>&lt;<a class="type" href="../../../String.html">String</a>&gt;</code></p></h3><div class="doc"><p></p></div></div><div class="platform platform-dox"><a name="savePath"></a><h3><p><code><span class="keyword">var</span> <a href="#savePath"><span class="identifier">savePath</span></a>:<a class="type" href="../../../String.html">String</a></code></p></h3><div class="doc"><p>The save path for the session files.</p>
<p>This should be absolute, or relative to the <code><a href="../../../ufront/web/context/HttpContext.html#contentDirectory">HttpContext.contentDirectory</a></code></p>
<p>Relative paths should not have a leading slash.
If a trailing slash is not included, it will be added.</p>
<p>This is set by injecting a String named "sessionSavePath", otherwise the default <code>defaultSavePath</code> value is used.</p></div></div><div class="platform platform-dox"><a name="sessionName"></a><h3><p><code><span class="keyword">var</span> <a href="#sessionName"><span class="identifier">sessionName</span></a>:<a class="type" href="../../../String.html">String</a></code></p></h3><div class="doc"><p>The variable name to reference the session ID.</p>
<p>This will be the name set in the Cookie sent to the client, or the name to search for in the parameters or cookies.</p>
<p>This is set by injecting a String named "sessionName", otherwise the default <code>defaultSessionName</code> value is used.</p></div></div><div class="platform platform-dox"><a name="new"></a><h3><p><code><span class="keyword">function</span> <a href="#new"><span class="identifier">new</span></a>():<a class="type" href="../../../Void.html">Void</a></code></p></h3><div class="doc"><p>Construct a new session object.</p>
<p>This does not create the session file or commit any data, rather, it sets up the object so that read or writes can then happen.</p>
<p>Data is read during <code>init</code> and written during <code>commit</code>.</p>
<p>A new session object should be created for each request, and it will then associate itself with the correct session file for the given user.</p>
<p>In general you should create your object using <code>injector.instantiate( <a href="../../../ufront/web/session/FileSession.html">FileSession</a> )</code>, so that the HttpContext is made available and various the <code>injectConfig</code> initializations take place.</p></div></div><div class="platform platform-dox"><a name="clear"></a><h3><p><code><span class="keyword">function</span> <a href="#clear"><span class="identifier">clear</span></a>():<a class="type" href="../../../Void.html">Void</a></code></p></h3><div class="doc"><p>Empty all items from the current session data without closing the session</p></div></div><div class="platform platform-dox"><a name="close"></a><h3><p><code><span class="keyword">function</span> <a href="#close"><span class="identifier">close</span></a>():<a class="type" href="../../../Void.html">Void</a></code></p></h3><div class="doc"><p>Close the session.</p>
<p>The sessionData and sessionID will be set to null, and the session will be flagged for deletion (when <code>commit</code> is called)</p></div></div><div class="platform platform-dox"><a name="commit"></a><h3><p><code><span class="keyword">function</span> <a href="#commit"><span class="identifier">commit</span></a>():<a class="type" href="../../../tink/Surprise.html">Surprise</a>&lt;<a class="type" href="../../../tink/Noise.html">Noise</a>, <a class="type" href="../../../String.html">String</a>&gt;</code></p></h3><div class="doc"><p>Commit if required.</p>
<p>Returns an Outcome, which is a Failure if the commit failed, usually because of not having permission to write to disk.</p></div></div><div class="platform platform-dox"><a name="exists"></a><h3><p><code><span class="keyword">function</span> <a href="#exists"><span class="identifier">exists</span></a>(name:<a class="type" href="../../../String.html">String</a>):<a class="type" href="../../../Bool.html">Bool</a></code></p></h3><div class="doc"><p>Check if a session has the specified item.</p></div></div><div class="platform platform-dox"><a name="get"></a><h3><p><code><span class="keyword">function</span> <a href="#get"><span class="identifier">get</span></a>(name:<a class="type" href="../../../String.html">String</a>):<a class="type" href="../../../Dynamic.html">Dynamic</a></code></p></h3><div class="doc"><p>Retrieve an item from the session data</p></div></div><div class="platform platform-dox"><a name="init"></a><h3><p><code><span class="keyword">function</span> <a href="#init"><span class="identifier">init</span></a>():<a class="type" href="../../../tink/Surprise.html">Surprise</a>&lt;<a class="type" href="../../../tink/Noise.html">Noise</a>, <a class="type" href="../../../String.html">String</a>&gt;</code></p></h3><div class="doc"><p>Initiate the session.</p>
<p>This will check for an existing session ID.  If one exists, it will read and unserialize the session data from that session's file.</p>
<p>If a session does not exist, one will be created.</p>
<p>This is called before any other operations which require access to the current session.</p></div></div><div class="platform platform-dox"><a name="injectConfig"></a><h3><p><code><span class="keyword">function</span> <a href="#injectConfig"><span class="identifier">injectConfig</span></a>():<a class="type" href="../../../Void.html">Void</a></code></p></h3><div class="doc"><p>Use the current injector to check for configuration for this session: sessionName, expiry and savePath.
If no values are available in the injector, the defaults will be used.
This will be called automatically after <code>context</code> has been injected.</p></div></div><div class="platform platform-dox"><a name="isActive"></a><h3><p><code><span class="keyword">function</span> <a href="#isActive"><span class="identifier">isActive</span></a>():<a class="type" href="../../../Bool.html">Bool</a></code></p></h3><div class="doc"><p>Whether or not the current session is active.</p>
<p>This is determined by if a sessionID exists, which will happen if init() has been called or if a SessionID was provided in the request context (via Cookie or GET/POST parameter etc).</p></div></div><div class="platform platform-dox"><a name="regenerateID"></a><h3><p><code><span class="keyword">function</span> <a href="#regenerateID"><span class="identifier">regenerateID</span></a>():<a class="type" href="../../../tink/Surprise.html">Surprise</a>&lt;<a class="type" href="../../../String.html">String</a>, <a class="type" href="../../../String.html">String</a>&gt;</code></p></h3><div class="doc"><p>Regenerate the ID for this session, renaming the file on the server and sending a new session ID to the cookie.</p></div></div><div class="platform platform-dox"><a name="remove"></a><h3><p><code><span class="keyword">function</span> <a href="#remove"><span class="identifier">remove</span></a>(name:<a class="type" href="../../../String.html">String</a>):<a class="type" href="../../../Void.html">Void</a></code></p></h3><div class="doc"><p>Remove an item from the session</p></div></div><div class="platform platform-dox"><a name="set"></a><h3><p><code><span class="keyword">function</span> <a href="#set"><span class="identifier">set</span></a>(name:<a class="type" href="../../../String.html">String</a>, value:<a class="type" href="../../../Dynamic.html">Dynamic</a>):<a class="type" href="../../../Void.html">Void</a></code></p></h3><div class="doc"><p>Set an item in the session data.</p>
<p>Note this will not commit the value to a file until dispose() is called (generally at the end of a request)</p></div></div><div class="platform platform-dox"><a name="setExpiry"></a><h3><p><code><span class="keyword">function</span> <a href="#setExpiry"><span class="identifier">setExpiry</span></a>(e:<a class="type" href="../../../Int.html">Int</a>):<a class="type" href="../../../Void.html">Void</a></code></p></h3><div class="doc"><p>Set the number of seconds the session should last</p>
<p>Note in this implementation only the cookie expiry is affected - the user could manually override this or send the session variable in the request parameters, and the session would still work.</p></div></div><div class="platform platform-dox"><a name="toString"></a><h3><p><code><span class="keyword">function</span> <a href="#toString"><span class="identifier">toString</span></a>():<a class="type" href="../../../String.html">String</a></code></p></h3><div class="doc"><p></p></div></div><div class="platform platform-dox"><a name="triggerCommit"></a><h3><p><code><span class="keyword">function</span> <a href="#triggerCommit"><span class="identifier">triggerCommit</span></a>():<a class="type" href="../../../Void.html">Void</a></code></p></h3><div class="doc"><p>Force the session to be committed at the end of this request</p></div></div></div></div></div></body></html>